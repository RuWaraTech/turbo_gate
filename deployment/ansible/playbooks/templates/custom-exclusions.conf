# ModSecurity Custom Exclusions for TurboGate
# Health check endpoints - bypass WAF completely
SecRule REQUEST_URI "@beginsWith /health" \
    "id:1000,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleEngine=Off"

SecRule REQUEST_URI "@beginsWith /lb-health" \
    "id:1001,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleEngine=Off"

SecRule REQUEST_URI "@beginsWith /gateway/health" \
    "id:1002,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleEngine=Off"

# TurboGate API specific exclusions
# Authentication endpoints - reduce false positives
SecRule REQUEST_URI "@beginsWith /api/v1/auth" \
    "id:1010,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920273"

# Webhook endpoints - often contain JSON that triggers false positives
SecRule REQUEST_URI "@beginsWith /webhook" \
    "id:1011,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920273,\
    ctl:ruleRemoveById=921110"

# File upload endpoints - reduce scanner interference
SecRule REQUEST_URI "@beginsWith /api/upload" \
    "id:1012,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920230"

# API documentation endpoints - bypass strict validation
SecRule REQUEST_URI "@beginsWith /docs" \
    "id:1013,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920300"

# Metrics endpoint exclusions
SecRule REQUEST_URI "@beginsWith /metrics" \
    "id:1014,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=920300"